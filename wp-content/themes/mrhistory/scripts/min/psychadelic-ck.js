var c=document.querySelector(".c"),ctx=c.getContext("2d"),w,h,t=0,max=Math.max,pow=Math.pow,sqrt=Math.sqrt,PI=Math.PI,sin=Math.sin,cos=Math.cos,n=8,m=4,p=32,r,beta,gamma,x0,y0,x1,y1,hue,t_step=1/60,requestID,trimUnit=function(t,e){return parseInt(t.split(e)[0],10)},spiral=function(){ctx.clearRect(0,0,w,h);for(var e=0;n*m>e;e++){beta=2*e*PI/(n*m),x0=0,ctx.beginPath(),hue=360*e/n,ctx.translate(w/2,h/2),ctx.rotate(t/3),ctx.fillStyle="hsl("+hue+", 100%, 100%)";for(var a=0;p>a;a++)gamma=2*a*PI/p,r=max(1,pow(2*a*(p-a),.43)-10),x0+=3.4*r,y0=x0*sin(gamma+2*t+x0/99)/5,x1=x0*cos(beta)-y0*sin(beta),y1=x0*sin(beta)+y0*cos(beta),ctx.moveTo(x1,y1),ctx.arc(x1,y1,r,0,2*PI);ctx.closePath(),ctx.fill(),ctx.rotate(-t/3),ctx.translate(-w/2,-h/2)}t+=t_step,requestID=requestAnimationFrame(spiral)},initCanvas=function(){var t;setTimeout(function(){t=getComputedStyle(c),w=c.width=trimUnit(t.width,"px"),h=c.height=trimUnit(t.height,"px"),requestID&&cancelAnimationFrame(requestID),spiral()},0)};initCanvas(),addEventListener("resize",initCanvas,!1);